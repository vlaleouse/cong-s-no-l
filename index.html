<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Planning cong√©s ‚Äì No√´l 2025/2026</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#111a33;
      --text:#e9eefc;
      --muted:#aeb9de;
      --present:#bff3cf;   /* vert */
      --leave:#b8d2ff;     /* bleu */
      --accent:#8b7dff;    /* violet */
      --border:rgba(255,255,255,.12);
      --soft:rgba(255,255,255,.06);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1000px 600px at 10% 0%, rgba(139,125,255,.25), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, rgba(184,210,255,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
    header{
      display:flex;gap:14px;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;
      margin-bottom:16px;
    }
    h1{margin:0;font-size:22px;letter-spacing:.2px}
    .sub{margin-top:6px;color:var(--muted);font-size:13px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius:14px;
      padding:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .search{
      flex:1 1 360px;
      display:flex;gap:10px;align-items:center;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(17,26,51,.7);
    }
    .search input{
      width:100%;
      border:0;
      outline:0;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .pill{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      color:var(--muted);
      font-size:12px;
      background:rgba(17,26,51,.55);
      white-space:nowrap;
    }
    .legend{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .dot{width:10px;height:10px;border-radius:3px;display:inline-block;margin-right:6px}
    .dot.present{background:var(--present)}
    .dot.leave{background:var(--leave)}

    .results{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 900px){
      .results{grid-template-columns:1fr}
    }
    .list{
      padding:10px;
      border:1px solid var(--border);
      border-radius:12px;
      background:rgba(17,26,51,.55);
      max-height:460px;
      overflow:auto;
    }
    .item{
      padding:10px 10px;
      border-radius:10px;
      cursor:pointer;
      display:flex;justify-content:space-between;align-items:center;
      gap:10px;
    }
    .item:hover{background:rgba(139,125,255,.12)}
    .item.active{background:rgba(139,125,255,.18);outline:1px solid rgba(139,125,255,.35)}
    .item small{color:var(--muted)}

    .details{
      padding:14px;
      border:1px solid var(--border);
      border-radius:12px;
      background:rgba(17,26,51,.55);
    }
    .details h2{margin:0 0 6px 0;font-size:18px}
    .meta{color:var(--muted);font-size:13px;margin-bottom:10px}

    .ranges{
      display:flex;flex-direction:column;gap:8px;margin:10px 0 14px 0;
    }
    .range{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
    }
    .badge{
      background:rgba(184,210,255,.16);
      border:1px solid rgba(184,210,255,.35);
      color:#eaf1ff;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      white-space:nowrap;
    }

    /* ‚úÖ Nouvelle vue : timeline compacte + tableau clair */
    .dayview{
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 980px){
      .dayview{grid-template-columns:1fr}
    }

    .timelineWrap{
      border:1px solid var(--border);
      border-radius:12px;
      background:rgba(255,255,255,.03);
      padding:10px;
    }
    .timelineHeader{
      display:flex;justify-content:space-between;align-items:center;gap:10px;
      margin-bottom:8px;
    }
    .timeline{
      display:flex;
      gap:6px;
      overflow-x:auto;
      padding-bottom:6px;
      scroll-snap-type:x mandatory;
    }
    .sq{
      flex:0 0 auto;
      width:54px;
      border:1px solid var(--border);
      border-radius:10px;
      padding:8px 8px;
      scroll-snap-align:start;
      background:rgba(17,26,51,.5);
    }
    .sq .d{font-weight:800;font-size:12px}
    .sq .s{font-size:12px;color:rgba(255,255,255,.85);margin-top:4px}
    .sq.present{background:rgba(191,243,207,.14)}
    .sq.leave{background:rgba(184,210,255,.16)}
    .hint{color:var(--muted);font-size:12px;margin-top:10px}

    .tableWrap{
      border:1px solid var(--border);
      border-radius:12px;
      background:rgba(255,255,255,.03);
      overflow:hidden;
    }
    .tableHead{
      display:flex;justify-content:space-between;align-items:center;
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      background:rgba(17,26,51,.55);
    }
    .tableHead b{font-size:13px}
    .scrollY{
      max-height:240px;
      overflow:auto;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    th, td{
      padding:10px 12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      text-align:left;
      white-space:nowrap;
    }
    th{color:var(--muted);font-weight:700;background:rgba(255,255,255,.02)}
    tr:hover td{background:rgba(139,125,255,.08)}
    .tag{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;border:1px solid var(--border);
      font-size:12px;
      background:rgba(17,26,51,.55);
    }
    .tag .dot{margin:0}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{
      border:1px solid var(--border);
      background:rgba(17,26,51,.6);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size:13px;
    }
    button:hover{background:rgba(139,125,255,.14)}
    .empty{
      padding:16px;border:1px dashed rgba(255,255,255,.18);
      border-radius:12px;color:var(--muted);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Planning cong√©s ‚Äì p√©riode No√´l (19/12/2025 ‚Üí 06/01/2026)</h1>
        <div class="sub">Recherche par pr√©nom/nom : affiche les dates de cong√©s pay√©s + une vue simple et lisible.</div>
      </div>
      <div class="legend">
        <span class="pill"><span class="dot present"></span>Pr√©sent</span>
        <span class="pill"><span class="dot leave"></span>Cong√©s pay√©s</span>
      </div>
    </header>

    <div class="card">
      <div class="row">
        <div class="search" role="search">
          <span style="color:var(--accent);font-weight:800">üîé</span>
          <input id="q" type="text" placeholder="Ex : Victor, C√©cile, Rapha√´lle‚Ä¶" autocomplete="off" />
          <span id="count" class="pill">13 salari√©s</span>
        </div>
        <span class="pill">Donn√©es : tableau fourni (No√´l)</span>
      </div>

      <div class="results">
        <div class="list" id="list"></div>

        <div class="details" id="details">
          <div class="empty">Tape un pr√©nom (ex : <b>Victor</b>) puis clique sur un salari√©.</div>
        </div>
      </div>
    </div>
  </div>

<script>
/**
 * Donn√©es (extraites du tableau envoy√©) :
 * - P√©riode affich√©e : 19/12/2025 ‚Üí 06/01/2026 (inclus)
 */
const DATA = [
  { name: "Christophe", leaves: [{ start: "2025-12-20", end: "2026-01-05" }] },
  { name: "C√©cile",     leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "√âmile",      leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "G√©rald",     leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "La√´titia",   leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "Marc Antoine",leaves:[{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "Nathalie",   leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "Ouadilia",   leaves: [{ start: "2025-12-20", end: "2026-01-05" }] },
  { name: "Philippe",   leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "Rapha√´lle Fe", leaves:[{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "Raphaelle Sauvage", leaves:[{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "S√©verine",   leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "Victor",     leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
];

const PERIOD_START = "2025-12-19";
const PERIOD_END   = "2026-01-06";

const $q = document.getElementById("q");
const $list = document.getElementById("list");
const $details = document.getElementById("details");
const $count = document.getElementById("count");

function normalize(str){
  return (str || "")
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .toLowerCase()
    .trim();
}
function parseISO(d){ return new Date(d + "T00:00:00"); }
function fmtFR(iso){
  const d = parseISO(iso);
  const dd = String(d.getDate()).padStart(2,"0");
  const mm = String(d.getMonth()+1).padStart(2,"0");
  const yyyy = d.getFullYear();
  return `${dd}/${mm}/${yyyy}`;
}
function dayLabel(iso){
  const d = parseISO(iso);
  const dd = String(d.getDate()).padStart(2,"0");
  const mm = String(d.getMonth()+1).padStart(2,"0");
  return `${dd}/${mm}`;
}
function eachDayISO(startISO, endISO){
  const out = [];
  let d = parseISO(startISO);
  const end = parseISO(endISO);
  while(d <= end){
    out.push(d.toISOString().slice(0,10));
    d.setDate(d.getDate()+1);
  }
  return out;
}
const PERIOD_DAYS = eachDayISO(PERIOD_START, PERIOD_END);

function isWithin(dateISO, startISO, endISO){
  const t = parseISO(dateISO).getTime();
  return t >= parseISO(startISO).getTime() && t <= parseISO(endISO).getTime();
}
function statusFor(employee, dateISO){
  for(const r of employee.leaves){
    if(isWithin(dateISO, r.start, r.end)) return "Cong√©s Pay√©s";
  }
  return "Pr√©sent";
}
function daysInLeaveWithinPeriod(employee){
  return PERIOD_DAYS.filter(d => statusFor(employee,d) === "Cong√©s Pay√©s").length;
}

/** Regrouper les jours CP en p√©riodes continues (utile si un jour tu as plusieurs plages) */
function compactLeaveRanges(employee){
  const days = PERIOD_DAYS.filter(d => statusFor(employee, d) === "Cong√©s Pay√©s");
  if(days.length === 0) return [];
  const ranges = [];
  let start = days[0];
  let prev = days[0];
  for(let i=1;i<days.length;i++){
    const cur = days[i];
    const prevDate = parseISO(prev); prevDate.setDate(prevDate.getDate()+1);
    const expected = prevDate.toISOString().slice(0,10);
    if(cur !== expected){
      ranges.push({start, end: prev});
      start = cur;
    }
    prev = cur;
  }
  ranges.push({start, end: prev});
  return ranges;
}

function renderList(filtered, activeName=null){
  $list.innerHTML = "";
  if(filtered.length === 0){
    $list.innerHTML = `<div class="empty">Aucun r√©sultat.</div>`;
    return;
  }
  for(const e of filtered){
    const cpDays = daysInLeaveWithinPeriod(e);
    const el = document.createElement("div");
    el.className = "item" + (e.name === activeName ? " active" : "");
    el.innerHTML = `
      <div>
        <div style="font-weight:800">${e.name}</div>
        <small>${cpDays} jour(s) de cong√©s sur la p√©riode</small>
      </div>
      <div class="pill">Voir</div>
    `;
    el.addEventListener("click", () => selectEmployee(e.name));
    $list.appendChild(el);
  }
}

function renderDetails(employee){
  const cpDays = daysInLeaveWithinPeriod(employee);
  const compact = compactLeaveRanges(employee);

  const compactHtml = compact.length
    ? compact.map(r => `
        <div class="range">
          <span class="badge">Cong√©s pay√©s</span>
          <div><b>Du</b> ${fmtFR(r.start)} <b>au</b> ${fmtFR(r.end)}</div>
          <div class="pill">${eachDayISO(r.start, r.end).length} jour(s)</div>
        </div>
      `).join("")
    : `<div class="range"><span class="badge">Pr√©sent</span><div>Aucun cong√© sur la p√©riode.</div></div>`;

  const timelineHtml = PERIOD_DAYS.map(d => {
    const st = statusFor(employee, d);
    const cls = st === "Cong√©s Pay√©s" ? "leave" : "present";
    return `
      <div class="sq ${cls}" title="${fmtFR(d)} ‚Äî ${st}">
        <div class="d">${dayLabel(d)}</div>
        <div class="s">${st === "Cong√©s Pay√©s" ? "Cong√©s" : "Pr√©sent"}</div>
      </div>
    `;
  }).join("");

  const rowsHtml = PERIOD_DAYS.map(d => {
    const st = statusFor(employee, d);
    const tag = st === "Cong√©s Pay√©s"
      ? `<span class="tag"><span class="dot leave"></span>Cong√©s pay√©s</span>`
      : `<span class="tag"><span class="dot present"></span>Pr√©sent</span>`;
    return `
      <tr>
        <td>${fmtFR(d)}</td>
        <td>${tag}</td>
      </tr>
    `;
  }).join("");

  $details.innerHTML = `
    <h2>${employee.name}</h2>
    <div class="meta">
      P√©riode : <b>${fmtFR(PERIOD_START)}</b> ‚Üí <b>${fmtFR(PERIOD_END)}</b> ‚Ä¢
      <b>${cpDays}</b> jour(s) en <b>cong√©s pay√©s</b>.
    </div>

    <div class="ranges">${compactHtml}</div>

    <div class="dayview">
      <div class="timelineWrap">
        <div class="timelineHeader">
          <div style="font-weight:800">Vue rapide (d√©filable)</div>
          <div class="pill">Scroll horizontal</div>
        </div>
        <div class="timeline">${timelineHtml}</div>

        <div class="btns">
          <button onclick="window.print()">Imprimer / PDF</button>
          <button onclick="copySummary()">Copier le r√©sum√©</button>
        </div>
        <div class="hint">Astuce : tu peux chercher sans accent (ex : ‚Äúraphaelle‚Äù).</div>
      </div>

      <div class="tableWrap">
        <div class="tableHead">
          <b>Jour par jour (lisible)</b>
          <span class="pill">Scroll vertical</span>
        </div>
        <div class="scrollY">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Statut</th>
              </tr>
            </thead>
            <tbody>${rowsHtml}</tbody>
          </table>
        </div>
      </div>
    </div>
  `;
}

function copySummary(){
  const active = window.__activeEmployee;
  if(!active) return;
  const e = DATA.find(x => x.name === active);
  const compact = compactLeaveRanges(e);
  const text = compact.length
    ? compact.map(r => `Cong√©s pay√©s : du ${fmtFR(r.start)} au ${fmtFR(r.end)}`).join(" | ")
    : "Aucun cong√© sur la p√©riode.";
  navigator.clipboard.writeText(`${e.name} ‚Äî ${text}`);
}

function selectEmployee(name){
  window.__activeEmployee = name;
  const e = DATA.find(x => x.name === name);
  renderDetails(e);

  const q = normalize($q.value);
  const filtered = DATA.filter(x => normalize(x.name).includes(q))
                       .sort((a,b) => a.name.localeCompare(b.name, "fr"));
  renderList(filtered, name);
}

function onSearch(){
  const q = normalize($q.value);
  const filtered = DATA
    .filter(x => normalize(x.name).includes(q))
    .sort((a,b) => a.name.localeCompare(b.name, "fr"));
  $count.textContent = `${filtered.length} salari√©(s)`;
  renderList(filtered, window.__activeEmployee);
}

$q.addEventListener("input", onSearch);

// init
$count.textContent = `${DATA.length} salari√©s`;
renderList([...DATA].sort((a,b)=>a.name.localeCompare(b.name, "fr")));
</script>
</body>
</html>
