<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Planning cong√©s ‚Äì No√´l 2025/2026</title>
  <style>
    :root{
      --bg:#0b1020;
      --text:#e9eefc;
      --muted:#aeb9de;
      --present:rgba(191,243,207,.18);
      --leave:rgba(184,210,255,.30);
      --accent:#8b7dff;
      --border:rgba(255,255,255,.12);
      --shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1000px 600px at 10% 0%, rgba(139,125,255,.25), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, rgba(184,210,255,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1200px;margin:28px auto;padding:0 16px}
    header{
      display:flex;gap:14px;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;
      margin-bottom:14px;
    }
    h1{margin:0;font-size:22px;letter-spacing:.2px}
    .sub{margin-top:6px;color:var(--muted);font-size:13px;max-width:820px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      box-shadow: var(--shadow);
    }

    .topbar{
      display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;
      margin-bottom:12px;
    }
    .left, .right{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .pill{
      padding:8px 10px;border-radius:999px;border:1px solid var(--border);
      color:var(--muted);font-size:12px;background:rgba(17,26,51,.55);
      white-space:nowrap;
    }
    .search{
      display:flex;gap:10px;align-items:center;
      padding:10px 12px;border-radius:12px;border:1px solid var(--border);
      background:rgba(17,26,51,.6);
      min-width:280px;
    }
    .search input{
      width:100%;border:0;outline:0;background:transparent;color:var(--text);font-size:14px;
    }
    select, button, label.toggle{
      border:1px solid var(--border);
      background:rgba(17,26,51,.6);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
    }
    button{cursor:pointer}
    button:hover{background:rgba(139,125,255,.14)}
    select{cursor:pointer}

    .toggle{
      display:flex;gap:8px;align-items:center;cursor:pointer;user-select:none;
      padding:10px 12px;
    }
    .toggle input{accent-color: var(--accent);}

    .legend{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .dot{width:10px;height:10px;border-radius:3px;display:inline-block}
    .dot.leave{background:rgba(184,210,255,.7)}
    .dot.present{background:rgba(191,243,207,.6)}

    .summary{
      display:flex;flex-wrap:wrap;gap:10px;align-items:flex-start;
      padding:12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:rgba(17,26,51,.45);
      margin-bottom:12px;
    }
    .summary h2{
      margin:0;
      font-size:14px;
      color:var(--muted);
      font-weight:700;
      width:100%;
    }
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(184,210,255,.35);
      background:rgba(184,210,255,.16);
      font-size:13px;
    }
    .chip.empty{
      border:1px dashed rgba(255,255,255,.18);
      background:transparent;
      color:var(--muted);
    }

    .gridWrap{
      border:1px solid var(--border);
      border-radius:14px;
      overflow:hidden;
      background:rgba(17,26,51,.45);
    }
    .scroll{overflow:auto;max-height:520px;}
    table{
      border-collapse:separate;
      border-spacing:0;
      width:max-content;
      min-width:100%;
      font-size:13px;
    }
    thead th{
      position:sticky; top:0; z-index:5;
      background:rgba(17,26,51,.92);
      border-bottom:1px solid var(--border);
      color:var(--muted);
      font-weight:800;
      text-align:center;
      padding:10px 10px;
      white-space:nowrap;
      cursor:pointer;
    }
    thead th:first-child{
      left:0; z-index:7;
      text-align:left;
      min-width:220px;
      padding-left:14px;
    }
    tbody td, tbody th{
      border-bottom:1px solid rgba(255,255,255,.08);
      border-right:1px solid rgba(255,255,255,.06);
      padding:10px 10px;
      text-align:center;
      white-space:nowrap;
    }
    tbody th{
      position:sticky; left:0; z-index:6;
      background:rgba(17,26,51,.88);
      text-align:left;
      font-weight:800;
      padding-left:14px;
      min-width:220px;
    }
    tbody tr:hover td{background:rgba(139,125,255,.08)}
    .cell.leave{background:var(--leave)}
    .cell.present{background:var(--present)}
    .cell.blank{background:transparent;color:transparent}
    .colActive{outline:2px solid rgba(139,125,255,.35); outline-offset:-2px}
    .cell.leave strong{color:#eef4ff}
    .cell.present strong{color:#f2fff6}

    .dow{display:block;font-size:11px;color:rgba(255,255,255,.55);font-weight:700;margin-top:3px}
    .date{display:block;font-size:12px;color:rgba(255,255,255,.9)}
    .hint{color:var(--muted);font-size:12px;margin-top:10px}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Planning cong√©s ‚Äì No√´l (19/12/2025 ‚Üí 06/01/2026)</h1>
        <div class="sub">
          Grille claire : <b>salari√©s √ó dates</b>. Clique une date pour voir <b>qui est en cong√©</b> ce jour-l√†.
        </div>
      </div>
      <div class="legend">
        <span class="pill"><span class="dot leave"></span> Cong√©s pay√©s</span>
        <span class="pill"><span class="dot present"></span> Pr√©sent</span>
      </div>
    </header>

    <div class="card">
      <div class="topbar">
        <div class="left">
          <div class="search">
            <span style="color:var(--accent);font-weight:900">üîé</span>
            <input id="q" type="text" placeholder="Chercher un salari√©‚Ä¶" autocomplete="off" />
          </div>

          <label class="toggle">
            <input id="showLeave" type="checkbox" checked />
            Afficher Cong√©s (CP)
          </label>
          <label class="toggle">
            <input id="showPresent" type="checkbox" checked />
            Afficher Pr√©sent
          </label>
        </div>

        <div class="right">
          <span id="count" class="pill">‚Äî</span>
          <select id="dateSelect" aria-label="Choisir une date"></select>
          <button id="goStart" type="button">Aller au 19/12</button>
        </div>
      </div>

      <div class="summary">
        <h2 id="summaryTitle">En cong√© ce jour :</h2>
        <div class="chips" id="chips"></div>
      </div>

      <div class="gridWrap">
        <div class="scroll">
          <table id="grid"></table>
        </div>
      </div>

      <div class="hint">Astuce : clique sur une <b>date</b> (en haut) pour surligner la colonne.</div>
    </div>
  </div>

<script>
/** ‚úÖ DONN√âES MISES √Ä JOUR (avec tes exceptions de pr√©sence) **/
const DATA = [
  // Christophe : CP du 20/12 au 05/01, mais pr√©sent 23 & 24/12
  { name: "Christophe", leaves: [
    { start: "2025-12-20", end: "2025-12-22" },
    { start: "2025-12-25", end: "2026-01-05" },
  ]},

  { name: "C√©cile",     leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "√âmile",      leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "G√©rald",     leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "La√´titia",   leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
  { name: "Marc Antoine", leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },
  { name: "Nathalie",   leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },

  // Ouadilia : CP du 20/12 au 05/01, mais pr√©sente le 24/12
  { name: "Ouadilia", leaves: [
    { start: "2025-12-20", end: "2025-12-23" },
    { start: "2025-12-25", end: "2026-01-05" },
  ]},

  // Philippe : CP du 19/12 au 05/01, mais pr√©sent 26, 29, 30/12
  { name: "Philippe", leaves: [
    { start: "2025-12-19", end: "2025-12-25" },
    { start: "2025-12-27", end: "2025-12-28" },
    { start: "2025-12-31", end: "2026-01-05" },
  ]},

  { name: "Rapha√´lle Fe", leaves: [{ start: "2025-12-19", end: "2026-01-05" }] },

  // Raphaelle Sauvage : CP du 25/12 au 05/01, mais pr√©sente 29 & 30/12
  { name: "Raphaelle Sauvage", leaves: [
    { start: "2025-12-25", end: "2025-12-28" },
    { start: "2025-12-31", end: "2026-01-05" },
  ]},

  // S√©verine : CP du 19/12 au 05/01, mais pr√©sente 29 & 30/12
  { name: "S√©verine", leaves: [
    { start: "2025-12-19", end: "2025-12-28" },
    { start: "2025-12-31", end: "2026-01-05" },
  ]},

  { name: "Victor",     leaves: [{ start: "2025-12-25", end: "2026-01-05" }] },
];

const PERIOD_START = "2025-12-19";
const PERIOD_END   = "2026-01-06";

const $q = document.getElementById("q");
const $grid = document.getElementById("grid");
const $count = document.getElementById("count");
const $chips = document.getElementById("chips");
const $summaryTitle = document.getElementById("summaryTitle");
const $dateSelect = document.getElementById("dateSelect");
const $showLeave = document.getElementById("showLeave");
const $showPresent = document.getElementById("showPresent");
const $goStart = document.getElementById("goStart");

function normalize(str){
  return (str || "")
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .toLowerCase()
    .trim();
}
function parseISO(d){ return new Date(d + "T00:00:00"); }
function fmtFR(iso){
  const d = parseISO(iso);
  const dd = String(d.getDate()).padStart(2,"0");
  const mm = String(d.getMonth()+1).padStart(2,"0");
  const yyyy = d.getFullYear();
  return `${dd}/${mm}/${yyyy}`;
}
function shortFR(iso){
  const d = parseISO(iso);
  const dd = String(d.getDate()).padStart(2,"0");
  const mm = String(d.getMonth()+1).padStart(2,"0");
  return `${dd}/${mm}`;
}
function dowFR(iso){
  const d = parseISO(iso);
  const map = ["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"];
  return map[d.getDay()];
}
function eachDayISO(startISO, endISO){
  const out = [];
  let d = parseISO(startISO);
  const end = parseISO(endISO);
  while(d <= end){
    out.push(d.toISOString().slice(0,10));
    d.setDate(d.getDate()+1);
  }
  return out;
}
const DAYS = eachDayISO(PERIOD_START, PERIOD_END);

function isWithin(dateISO, startISO, endISO){
  const t = parseISO(dateISO).getTime();
  return t >= parseISO(startISO).getTime() && t <= parseISO(endISO).getTime();
}
function isLeave(employee, dateISO){
  return employee.leaves.some(r => isWithin(dateISO, r.start, r.end));
}

let activeDate = PERIOD_START;

function fillDateSelect(){
  $dateSelect.innerHTML = "";
  for(const d of DAYS){
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = `${dowFR(d)} ${shortFR(d)} (${d.slice(0,4)})`;
    $dateSelect.appendChild(opt);
  }
  $dateSelect.value = activeDate;
}

function renderSummary(employees){
  const off = employees.filter(e => isLeave(e, activeDate)).map(e => e.name);
  $summaryTitle.textContent = `En cong√© le ${fmtFR(activeDate)} : (${off.length})`;
  $chips.innerHTML = "";
  if(off.length === 0){
    const empty = document.createElement("div");
    empty.className = "chip empty";
    empty.textContent = "Personne en cong√© ce jour-l√†";
    $chips.appendChild(empty);
    return;
  }
  for(const name of off){
    const chip = document.createElement("div");
    chip.className = "chip";
    chip.textContent = name;
    $chips.appendChild(chip);
  }
}

function renderGrid(){
  const q = normalize($q.value);
  const showLeave = $showLeave.checked;
  const showPresent = $showPresent.checked;

  const employees = DATA
    .filter(e => normalize(e.name).includes(q))
    .sort((a,b)=>a.name.localeCompare(b.name,"fr"));

  $count.textContent = `${employees.length} salari√©(s) affich√©(s) ‚Ä¢ P√©riode ${shortFR(PERIOD_START)} ‚Üí ${shortFR(PERIOD_END)}`;

  renderSummary(employees);

  let html = "";
  html += "<thead><tr>";
  html += `<th>Salari√©</th>`;
  for(const d of DAYS){
    const active = d === activeDate ? " colActive" : "";
    html += `<th class="${active}" data-date="${d}">
      <span class="date">${shortFR(d)}</span>
      <span class="dow">${dowFR(d)}</span>
    </th>`;
  }
  html += "</tr></thead>";

  html += "<tbody>";
  for(const e of employees){
    html += `<tr><th>${e.name}</th>`;
    for(const d of DAYS){
      const off = isLeave(e, d);
      const active = d === activeDate ? " colActive" : "";

      if(off){
        // CP
        html += showLeave
          ? `<td class="cell leave${active}"><strong>CP</strong></td>`
          : `<td class="cell blank${active}">.</td>`;
      } else {
        // Pr√©sent
        html += showPresent
          ? `<td class="cell present${active}"><strong>PR</strong></td>`
          : `<td class="cell blank${active}">.</td>`;
      }
    }
    html += "</tr>";
  }
  html += "</tbody>";

  $grid.innerHTML = html;

  $grid.querySelectorAll("thead th[data-date]").forEach(th=>{
    th.addEventListener("click", ()=>{
      activeDate = th.dataset.date;
      $dateSelect.value = activeDate;
      renderGrid();
    });
  });
}

/*** Events ***/
$q.addEventListener("input", renderGrid);
$showLeave.addEventListener("change", renderGrid);
$showPresent.addEventListener("change", renderGrid);
$dateSelect.addEventListener("change", (e)=>{
  activeDate = e.target.value;
  renderGrid();
});
$goStart.addEventListener("click", ()=>{
  activeDate = PERIOD_START;
  $dateSelect.value = activeDate;
  renderGrid();
});

/*** Init ***/
fillDateSelect();
renderGrid();
</script>
</body>
</html>
